SELECT *
FROM (
    SELECT PRODUCT, YEAR, SALES SALES 
    FROM SALES
)
PIVOT (
    SUM(SALES) FOR YEAR IN (2021,2022,2023)
);

SELECT PRODUCT, YEAR, SALES
FROM (
    SELECT PRODUCT, YEAR_2021, YEAR_2022
    FROM (
        SELECT PRODUCT, YEAR, SALES
        FROM SALES
    )
    PIVOT (
        SUM(SALES) FOR YEAR IN (2021 AS "YEAR_2021", 2022 AS "YEAR_2022")
    )
)
UNPIVOT (
    SALES FOR YEAR IN (YEAR_2021 AS '2021', YEAR_2022 AS '2022')
);

